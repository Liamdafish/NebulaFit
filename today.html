<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Today | Astronaut Fitness Tracker</title>
  <link rel="stylesheet" href="style.css">
  <script src="script.js" defer></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* Styling the particles background */
    #particles-js {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    /* Content styles */
    .content {
      position: relative;
      z-index: 1;
      padding-top: 60px; /* Adjusted to ensure content isn't hidden under fixed navbar */
    }

    .inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    #stepsChart, #waterSleepChart {
      width: 400px;
      height: 400px;
    }

    /* Tab Bar Styles */
    .tabbar {
      background-color: #333;
      overflow: hidden;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 10;
      display: flex;
      justify-content: center;
    }

    .tabbar a {
      float: left;
      display: block;
      color: white;
      text-align: center;
      padding: 14px 20px;
      text-decoration: none;
    }

    .tabbar a:hover {
      background-color: #ddd;
      color: black;
    }

    .tabbar .active {
      background-color: #4CAF50;
      color: white;
    }

    /* Tab bar responsive behavior */
    @media (max-width: 600px) {
      .tabbar a {
        padding: 10px 15px;
      }
    }
  </style>
</head>
<body>
  <div id="particles-js"></div>

  <!-- Fixed Navigation Bar -->
  <nav class="tabbar">
    <a href="index.html">Home</a>
    <a href="today.html" class="active">Today</a>
    <a href="logs.html">Logs</a>
    <a href="profile.html">Profile</a>
  </nav>

  <div class="content">
    <header>
      <h1>Log Your Sleep, Steps, and Water</h1>
    </header>
    <main>
      <!-- Log Fitness Data Section -->
      <section>
        <h2>Log Your Fitness Data</h2>
        <div class="inputs">
          <div>
            <label for="steps">Steps</label>
            <input id="steps" type="number">
          </div>
          <div>
            <label for="water">Water Intake (L)</label>
            <input id="water" type="number" step="0.1">
          </div>
          <div>
            <label for="sleep">Sleep (Hours)</label>
            <input id="sleep" type="number" step="0.1">
          </div>
        </div>
        <button id="submit">Submit</button>
      </section>

      <!-- Fitness Logs Table -->
      <section>
        <h2>Fitness Logs</h2>
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Steps</th>
              <th>Water Intake (L)</th>
              <th>Sleep (Hours)</th>
              <th>Edit</th>
              <th>Delete</th>
            </tr>
          </thead>
          <tbody id="logsSection">
            <!-- Logs will be dynamically injected here -->
          </tbody>
        </table>
      </section>

      <!-- Charts Section -->
      <section>
        <h2>Charts</h2>
        <canvas id="stepsChart"></canvas> <!-- Steps Chart -->
        <canvas id="waterSleepChart"></canvas> <!-- Water & Sleep Chart -->
      </section>
    </main>
  </div>

  <!-- Particle.js Initialization -->
  <script>
    particlesJS('particles-js', {
      "particles": {
        "number": {
          "value": 80,
          "density": {
            "enable": true,
            "value_area": 800
          }
        },
        "color": { "value": "#ffffff" },
        "shape": { "type": "circle" },
        "size": { "value": 3, "random": true },
        "move": { "enable": true, "speed": 2, "direction": "none" }
      }
    });
  </script>

  <!-- JavaScript to handle data logging and chart updates -->
  <script>
    document.getElementById('submit').addEventListener('click', () => {
      const steps = document.getElementById('steps').value;
      const water = document.getElementById('water').value;
      const sleep = document.getElementById('sleep').value;

      // Log data
      const log = {
        date: new Date().toLocaleDateString(),
        steps,
        water,
        sleep
      };

      // Insert log into table
      const tableBody = document.getElementById('logsSection');
      const row = tableBody.insertRow();
      row.innerHTML = `
        <td>${log.date}</td>
        <td>${log.steps}</td>
        <td>${log.water}</td>
        <td>${log.sleep}</td>
        <td><button onclick="editRow(this)">Edit</button></td>
        <td><button onclick="deleteRow(this)">Delete</button></td>
      `;

      // Update charts with new data
      updateCharts(steps, water, sleep);
    });

    function editRow(button) {
      const row = button.closest('tr');
      const cells = row.getElementsByTagName('td');
      document.getElementById('steps').value = cells[1].innerText;
      document.getElementById('water').value = cells[2].innerText;
      document.getElementById('sleep').value = cells[3].innerText;
      row.remove();
    }

    function deleteRow(button) {
      const row = button.closest('tr');
      row.remove();
    }

    function updateCharts(steps, water, sleep) {
      // Update the Steps Chart
      const stepsChart = new Chart(document.getElementById('stepsChart'), {
        type: 'bar',
        data: {
          labels: ['Steps'],
          datasets: [{
            label: 'Steps for Today',
            data: [steps],
            backgroundColor: ['rgba(75, 192, 192, 0.2)'],
            borderColor: ['rgba(75, 192, 192, 1)'],
            borderWidth: 1
          }]
        }
      });

      // Update the Water & Sleep Chart
      const waterSleepChart = new Chart(document.getElementById('waterSleepChart'), {
        type: 'bar',
        data: {
          labels: ['Water (L)', 'Sleep (Hours)'],
          datasets: [{
            label: 'Water and Sleep for Today',
            data: [water, sleep],
            backgroundColor: ['rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)'],
            borderColor: ['rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)'],
            borderWidth: 1
          }]
        }
      });
    }
  </script>
</body>
</html>
