<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Today | Astronaut Fitness Tracker</title>
  <link rel="stylesheet" href="style.css">
  <script src="script.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Chart.js -->
</head>
<body>
  <div class="content">
    <header>
      <h1>Today</h1>
    </header>
    <main>
      <!-- Food Data Search -->
      <section>
        <h2>Search for Food</h2>
        <div>
          <input type="text" id="foodInput" placeholder="Search for food (e.g., apple)" />
          <button onclick="searchFood()">Search</button>
        </div>
        <div id="searchResults"></div>
      </section>

      <!-- Food Data Chart -->
      <section>
        <h2>Food Caloric Information</h2>
        <canvas id="foodDataChart" width="400" height="200"></canvas>
      </section>

      <!-- Log Fitness Data -->
      <section>
        <h2>Log Fitness Data</h2>
        <div class="inputs">
          <div>
            <label for="steps">Steps</label>
            <input id="steps" type="number">
          </div>
          <div>
            <label for="water">Water Intake (L)</label>
            <input id="water" type="number" step="0.1">
          </div>
          <div>
            <label for="sleep">Sleep (Hours)</label>
            <input id="sleep" type="number" step="0.1">
          </div>
        </div>
        <button id="submit" onclick="addFitnessData()">Submit</button>
      </section>

      <!-- Fitness Log (Steps, Water, Sleep) -->
      <section>
        <h2>Fitness Log</h2>
        <div id="fitnessLog">
          <p>Steps: <span id="logSteps">0</span></p>
          <p>Water Intake (L): <span id="logWater">0</span></p>
          <p>Sleep (Hours): <span id="logSleep">0</span></p>
        </div>
      </section>
    </main>
  </div>

  <script>
    // API Key and Base URL for Spoonacular API
    const apiKey = 'b86ae26b7f844ead91ce96df1eb8df0c';
    const baseURL = 'https://api.spoonacular.com/food/ingredients/search';

    // Chart for Food Data (Calories)
    const foodDataChartCtx = document.getElementById('foodDataChart').getContext('2d');
    let foodDataChart = new Chart(foodDataChartCtx, {
      type: 'pie',
      data: {
        labels: [],
        datasets: [{
          label: 'Food Caloric Information',
          data: [],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(153, 102, 255, 0.2)'
          ],
          borderColor: [
            'rgba(255, 99, 132, 1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(153, 102, 255, 1)'
          ],
          borderWidth: 1
        }]
      }
    });

    // Function to search food via Spoonacular API
    function searchFood() {
      const query = document.getElementById('foodInput').value;
      fetch(`${baseURL}?query=${query}&number=5&sort=calories&sortDirection=desc&apiKey=${apiKey}`)
        .then(response => response.json())
        .then(data => {
          const searchResultsDiv = document.getElementById('searchResults');
          searchResultsDiv.innerHTML = '';
          let labels = [];
          let calories = [];
          data.results.forEach(item => {
            labels.push(item.name);
            calories.push(item.calories || 0); // Handling if calories data is missing
            searchResultsDiv.innerHTML += `<p>${item.name} - ${item.calories || 'N/A'} Calories</p>`;
          });
          
          // Update food data chart with food names and calories
          foodDataChart.data.labels = labels;
          foodDataChart.data.datasets[0].data = calories;
          foodDataChart.update();
        })
        .catch(error => console.error('Error fetching food data:', error));
    }

    // Function to handle adding fitness data (steps, water, sleep)
    function addFitnessData() {
      const steps = document.getElementById('steps').value || 0;
      const water = document.getElementById('water').value || 0;
      const sleep = document.getElementById('sleep').value || 0;

      // Display the fitness data in the log
      document.getElementById('logSteps').textContent = steps;
      document.getElementById('logWater').textContent = water;
      document.getElementById('logSleep').textContent = sleep;
    }
  </script>
</body>
</html>
